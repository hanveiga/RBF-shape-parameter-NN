6# RBF-shape-parameter-NN

Repository associated to the paper: "Learning a robust shape parameter for RBF approximation" (https://arxiv.org/abs/2408.05081)

In this repository, you will be able to reproduce the results of the paper, as well as generate your own dataset and train your own neural network to estimate the shape parameter for an interpolation matrix.

Each numerical experiment can be reproduced by its corresponding jupyter notebook. To guarantee compatibility, please install the enviroment provided on ``env.yml``.

## Installing environment

~~~
conda env create -f env.yml
~~~

## Dataset generation
In the folder ``dataset/`` the notebook ``generate_dataset.ipynb`` will create the datasets as described in Tables A.11 and A.12 of the paper. The dataset used in this work is ``sort_1d_11_11.5.pkl`` and ``sort_2d_11_11.5.pkl``.

## Neural network training
In the folder ``network/`` the notebook ``generate_nn.ipynb`` uses the generated datasets in folder dataset/, ``sort_1d_11_11.5.pkl`` and ``sort_2d_11_11.5.pkl``.
Using those datapoints, it generates distance matrices and sets-up the learning problem. 
It outputs the best obtained model, ``best_model.pt`` in a user-defined folder (default: ``results_sorted_1d_2d/``).

## Numerical experiments
### Figure 3
![/images/range0.1_test_stability_inf_interval_NEW.png](https://github.com/hanveiga/RBF-shape-parameter-NN/blob/main/images/range0.1_test_stability_inf_interval_NEW.png)

This can be generated by the notebook: ``1-dimensional/figure-3.ipynb``. It compares various techniques to estimate the shape parameter on an example.

Below, you can find the corresponding jupyter notebook to reproduce the results on section 5. The notebook will produce the convergence plots (errors) and compute the computational timings (in the interpolation tasks). 

| Experiment   | Notebook  | Comments |
|---|---|---|
|1-dimensional interpolation   | ``1-dimensional/interpolation_1d.ipynb``   |   Prints the computational timing tables and outputs error curve plots |
|1-dimensional heat equation   |  ``1-dimensional/heat_1d.ipynb``  | Outputs the error curve plots |
|2-dimensional interpolation   | ``2-dimensional/interpolation_2d.ipynb``   | Prints the computational timing tables and outputs error curve plots|
|2-dimensional heat equation   |  ``2-dimensional/heat_2d.ipynb`` |  Outputs the error curve plots |
|2-dimensional initial boundary problem   |   ``2-dimensional/bvp_2d.ipynb`` |  Outputs the error curve plots  |
|image distortion (interpolation)   |   ``2-dimensional/correct_distortion.ipynb`` |  Outputs the corrected images and quality metrics table|
|image upscaling (interpolation)   |   ``2-dimensional/downscaling_upscaling.ipynb`` |  Outputs the corrected images and quality metrics table |
|1-dimensional interpolation with fallback   |  ``1-dimensional/interpolation_1d-with-fall-back.ipynb``  | Outputs the error curves|

### Appendix 
In ``1-dimensional/appendix-B.ipynb``, one can reproduce the study shown in Appendix B on the candidate sets for Rippa and MLE methods.
